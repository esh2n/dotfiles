// Zellij Configuration - Unified with tmux/WezTerm (Prefix: Ctrl+q)
default_layout "default"

plugins {
    zjstatus location="file:~/.config/zellij/plugins/zjstatus.wasm"
}
mouse_mode true
pane_frames false
copy_command "pbcopy"

keybinds {
    normal clear-defaults=true {
        // Prefix key (Ctrl+q) - switch to locked mode for tmux-like bindings
        bind "Ctrl q" { SwitchToMode "locked"; }

        // Tab navigation (no prefix, like tmux)
        bind "Ctrl h" { GoToPreviousTab; }
        bind "Ctrl l" { GoToNextTab; }

        // Tab shortcuts
        bind "Alt 1" { GoToTab 1; }
        bind "Alt 2" { GoToTab 2; }
        bind "Alt 3" { GoToTab 3; }
        bind "Alt 4" { GoToTab 4; }
        bind "Alt 5" { GoToTab 5; }

        // Plugin shortcuts
        bind "Alt f" {
            LaunchPlugin "file:~/.config/zellij/plugins/monocle.wasm" {
                floating true
            }
            SwitchToMode "normal"
        }
        bind "Alt h" {
            LaunchOrFocusPlugin "file:~/.config/zellij/plugins/harpoon.wasm" {
                floating true
                move_to_focused_tab true
            }
            SwitchToMode "normal"
        }
    }

    // Locked mode acts as "Prefix mode" (like tmux Ctrl+q)
    locked clear-defaults=true {
        // Exit prefix mode
        bind "Esc" { SwitchToMode "normal"; }
        bind "Ctrl q" { SwitchToMode "normal"; }

        // Split panes (like tmux/WezTerm)
        bind "\\" { NewPane "Right"; SwitchToMode "normal"; }
        bind "-" { NewPane "Down"; SwitchToMode "normal"; }

        // Pane navigation (like tmux/WezTerm)
        bind "h" { MoveFocus "Left"; SwitchToMode "normal"; }
        bind "j" { MoveFocus "Down"; SwitchToMode "normal"; }
        bind "k" { MoveFocus "Up"; SwitchToMode "normal"; }
        bind "l" { MoveFocus "Right"; SwitchToMode "normal"; }

        // Pane zoom (like tmux/WezTerm)
        bind "z" { ToggleFocusFullscreen; SwitchToMode "normal"; }

        // Pane close (like tmux/WezTerm)
        bind "x" { CloseFocus; SwitchToMode "normal"; }

        // Pane resize
        bind "H" { Resize "Left"; }
        bind "J" { Resize "Down"; }
        bind "K" { Resize "Up"; }
        bind "L" { Resize "Right"; }

        // Tab operations
        bind "t" { NewTab; SwitchToMode "normal"; }
        bind "Tab" { GoToNextTab; SwitchToMode "normal"; }

        // Scroll/copy mode (like tmux)
        bind "[" { SwitchToMode "scroll"; }

        // Session
        bind "d" { Detach; }
        bind "Ctrl c" { NewTab; SwitchToMode "normal"; }
    }

    scroll clear-defaults=true {
        bind "Esc" { SwitchToMode "normal"; }
        bind "q" { SwitchToMode "normal"; }
        bind "j" { ScrollDown; }
        bind "k" { ScrollUp; }
        bind "Ctrl d" { HalfPageScrollDown; }
        bind "Ctrl u" { HalfPageScrollUp; }
        bind "v" { SwitchToMode "entersearch"; }
    }

    entersearch clear-defaults=true {
        bind "Esc" { SwitchToMode "scroll"; }
        bind "Enter" { SwitchToMode "search"; }
    }

    search clear-defaults=true {
        bind "Esc" { SwitchToMode "normal"; }
        bind "n" { Search "Down"; }
        bind "N" { Search "Up"; }
    }
}

show_startup_tips false